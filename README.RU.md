# Описание

[LayersCollection](http://edward17.github.io/LayersCollection/) - сборник растровых слоёв, основанных на данных OpenStreetMap, и слоёв, которые могут использоваться для редактирования OSM. К последним относятся спутниковые снимки и GPS-треки.

Также присутствуют слои рельефа и карта покрытия панорам [Mapillary](http://www.mapillary.com/).

# Цель

Этот проект предназначен для того, чтобы:

* Показать людям, на что способен OpenStreetMap
* Сделать жизнь OSMера комфортнее
* Облегчить разработчикам выбор и встраивание слоя на основе OpenStreetMap

# Функции

## Слои

Слои бывают следующих типов:

* Базовый слой (Baselayer) - слой, лежащий на фоне карты; слой, на который накладывается всё остальное
* Накладываемый слой (Overlay) - слой с прозрачным фоном, который можно наложить на базовый слой. Поддерживается одновременный показ нескольких накладывающихся слоёв. Они показываются в том порядке, в котором были включены

Также вместо базового слоя можно сделать фон чёрным (кнопка "Set black background") или серым (кнопка "Set gray background").

Иногда бывает так, что показаны много накладываемых слоёв, и их все нужно скрыть. Чтобы не листать список слоёв и не снимать кучу галочек, можно просто нажать на кнопку "Remove all overlays".

### Показ предыдущего базового слоя

Иногда бывает необходимо сравнить одно и то же место на карте на разных слоях (например, OpenStreetMap и спутниковые снимки). Порядок действий следующий:

1. Приблизить карту к необходимому месту
2. Показать один слой
3. Показать другой слой
4. Поставить курсор мыши на кнопку "Show previous baselayer"
5. Нажимать на неё каждый раз, когда необходимо сменить слой

Обратите внимание: история всех показанных слоёв **не** хранится.

### Категории

Категория - это слои под заголовком (до другого заголовка). Все слои в одной категории относятся к одной теме. Например, в категории "General" собраны слои без уклона на что-либо (они показывают всё сразу, грубо говоря). В категории "Public Transport" - как можно догадаться из названия, находятся слои, отображающие маршруты общественного транспорта.

Категории можно свернуть, чтобы сделать список слоёв короче, а время его прокрутки - меньше. Для этого нужно нажать на галочку рядом с соответствующей категорией.

## Ссылка на координаты и слои

Есть возможность скопировать ссылку на место на карте и выбранный слой (или слои, если показан хотя бы один накладываемый слой). Для этого нужно нажать на ссылку "Permalink" в левом верхнем углу экрана и скопировать адрес из адресной строки браузера. Также можно просто скопировать адрес ссылки. Координаты и выбранные слои в ссылке обновляются автоматически при их изменении.

Данные о координатах и слое (слоях) хранятся в хеше - это часть URL после символа `#`.

Формат получаемого хеша - как на [http://www.openstreetmap.org/](http://www.openstreetmap.org/): `#map={зум}/{широта (latitude)}/{долгота (longitude)}&layers={список слоёв в формате "базовый слой [,накладывающийся слой 1] [,накладывающийся слой 2]..."}`

На вход сайт принимает несколько форматов хешей:

* Описанный выше. Используется, например, на http://www.openstreetmap.org/ и http://www.openstreetmap.ru/
* `#zoom={зум}&lat={широта (latitude)}&lon={долгота (longitude)}`. Используется, например, на [http://pavlo-dudka.github.io/](http://pavlo-dudka.github.io/osm-pg-tests/test.html?map?dead.nodes#zoom=6&lat=49&lon=31)
* `#{зум}/{широта (latitude)}/{долгота (longitude)}`. Используется, например, на [http://resultmaps.neis-one.org/osm-changesets](http://resultmaps.neis-one.org/osm-changesets?comment=mapping_party#18/44.51155/11.33740)

Благодаря этому можно быстро переходить с одного сайта на другой. Например, вы увидели ошибку в одном из валидаторов [http://pavlo-dudka.github.io/](http://pavlo-dudka.github.io/), и хотите посмотреть, как выглядит данное место на спутниковых снимках. Порядок действий следующий:

1. Скопировать ссылку на это место на этом сайте
2. Вставить её в адресную строку или любое другое поле ввода
3. Оставить только хеш, всё остальное удалить
4. Скопировать полученный хеш
5. Набрать в адресной строке `http://edward17.github.io/LayersCollection/` и вставить в конце полученный хеш
6. Карта откроется на этом месте. Теперь можно переключиться, например, на слой спутниковых снимков

В хеше с сайта http://www.openstreetmap.org/ хранятся не только координаты, но и выбранный слой. Если вставить такой хеш, то на карте автоматически будет показан этот слой.

Также можно использовать данный сайт как конвертер координат из разных форматов в формат [http://www.openstreetmap.org/](http://www.openstreetmap.org/).

## Фильтры

На данный момент на сайте собрано достаточно много самых разных слоёв. Для того, чтобы облегчить поиск слоя по определённым критериям, созданы фильтры:

* Language (код языка на зелёном фоне) - язык надписей на карте
* Show outdated layers (красный "old") - показывать слои, которые давно не обновлялись
* Show Ukraine-only layers (жёлтый "ua") - показывать слои, которые покрывают только Украину. Актуально для жителей других стран, которые не найдут на этих слоях ничего интересного
* Show only black/white layers (серый "b/w") - показывать **только** чёрно-белые слои. Могут использоваться, например, для печати
* Show only 3D-buildings layers (фиолетовый "3D") - показывать **только** слои, у которых на больших зумах рисуются объёмные здания
* Show only Retina layers (оранжевый "rtn") - показывать **только** слои для экранов Retina
* Show only no-labels layers (тёмно-синий "nl") - показывать **только** слои, не содержащие надписей. Они могут использоваться как основа для своих надписей

Поддерживается активация нескольких фильтров одновременно.

Кроме того, каждый фильтр имеет определённую "бирку" (в списке выше они указаны в скобках). Если слой попадает под данный фильтр, бирка этого фильтра отображается справа возле названия слоя.

## Собственный слой

Есть возможность показывать собственный тайловый или WMS слой. Для этого нажмите на кнопку "Add custom layer" (или "Add custom WMS layer") и заполните поля в появившейся форме. Обязательные поля отмечены `*`. После чего нажмите кнопку "Show this layer" (или "Show this WMS layer").

Собственный слой добавляется поверх того, который сейчас выбран в списке. Если ваш слой имеет прозрачный фон, но вы хотите видеть его без подложки, то нажмите на кнопку "Set gray background" в списке слоёв.

Поддерживается показ собственных тайлового и WMS слоёв одновременно.

Обратите внимание:

1. Данные этого слоя (адрес, копирайты, максимальный зум) не сохраняются и при перезагрузке страницы будут потеряны
2. С помощью этого инструмента нельзя попросить автора (меня) добавить новый слой в сборник. Для этого нужно связаться со мной, см. раздел [Контакты](https://github.com/Edward17/LayersCollection/blob/gh-pages/README.RU.md#Контакты)

## Экспорт данных слоя

Есть возможность экспортировать данные слоя (адрес, максимальный зум и др.) для использования в следующем ПО:

* Библиотека [Leaflet](http://leafletjs.com/) - для неё возвращается готовый JavaScript-код, который просто нужно вставить в код сайта
* Редактор iD - для него возвращается адрес, который можно вставить при подключении настраиваемого слоя
* Редактор JOSM - для него возвращается адрес и максимальный зум (для TMS слоя) или адрес, список слоёв и формат (для WMS слоя)
* SAS.Planet - для неё возвращаются тексты трёх файлов, которые нужно положить в отдельную папку в директории `SAS.Planet/Maps/.../` по аналогии с другими слоями (поддерживаются только тайловые слои)

Чтобы экспортировать данные слоя, нужно:

1. Включить галочку "Show layer data by doubleclick on layer name"
2. Два раза кликнуть на **название** слоя
3. Откроется новая вкладка, оттуда можно скопировать результат

## Вставка мини-карты на сайт

Есть возможность вставить на свой сайт мини-карту с выбранными слоями (базовый слой и неограниченное количество накладывающихся слоёв) и заданной начальной позицией с помощью `<iframe>`. Для этого нужно:

1. Открыть необходимое место на карте
2. Включить слои в необходимом порядке
3. Нажать на ссылку "Frame export"
4. Скопировать полученный код и вставить в HTML-код своего сайта

## Сохранение состояния сайта

Интерфейс сайта можно конфигурировать. Некоторые параметры хранятся только в браузере. Другие параметры хранятся в браузере и передаются в ссылке. При этом параметры в ссылке всегда приоритетнее, чем параметры, сохранённые в браузере.

Следующие параметры хранятся только в браузере:

* Показывать ли левую панель? (На ней расположены фильтры, список слоёв и многое другое)
* Показывать ли фильтры?
* Активирован ли каждый фильтр?
* Показывать ли каждую категорию?

Следующие параметры хранятся в браузере и в ссылке:

* Координаты (широта, долгота, зум)
* Показываемые слои

# Лицензия

См. [LICENSE.md](https://github.com/Edward17/LayersCollection/blob/gh-pages/LICENSE.md)

# Контакты

Есть вопросы, предложения, пожелания? Пишите мне в [личном сообщении на OSM](https://www.openstreetmap.org/message/new/edward17) или на e-mail: edward17 [at] mail [dot] ua.