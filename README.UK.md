# Опис

[LayersCollection](http://edward17.github.io/LayersCollection/) - збірник растрових шарів, заснованих на даних OpenStreetMap, і шарів, які дозволено використовувати для редагування OSM. До останніх належать супутникові знімки та GPS-треки

Також наявні шари з рельєфом та мапа покриття панорам [Mapillary](http://www.mapillary.com/).

# Ціль

Цей проект призначений для того, щоб:

* Показати людям, на що здатен OpenStreetMap
* Зробити життя учасника OSM комфортніше
* Полегшити розробникам вибір і вбудування шару на основі OpenStreetMap

# Функції

## Шари

Шари бувають наступних типів:

* Базовий шар (Baselayer) - шар, що лежить на тлі мапи; шар, на який можна накладати все інше
* Накладний шар (Overlay) - шар з прозорим тлом, який можна накласти на базовий шар. Підтримується одночасний показ кількох накладних шарів. Вони показуються у тому порядку, в якому були увімкнені

Також замість базового шару можна зробити фон чорним (кнопка "Set black background") або сірим (кнопка "Set gray background").

Іноді буває так, що показується багато накладних шарів, і всі їх потрібно сховати. Щоб не бігати переліком шарів і не знімати багато флажків, можна просто натиснути на кнопку "Remove all overlays".

### Показ попереднього базового шару

Іноді буває потрібно порівняти якесь місце на мапі на різних шарах (наприклад, OpenStreetMap і супутникові знімки). Порядок дій наступний:

1. Наблизити мапу до необхідного місця
2. Показати один шар
3. Показати інший шар
4. Поставити курсор миші на кнопку "Show previous baselayer"
5. Натискати її кожного разу, коли необхідно змінити шар

Зверніть увагу: історія усіх показаних шарів **не** зберігається.

### Категорії

Категорія - це шари під заголовком (до іншого заголовку). Усі шари в одній категорії належать до однієї теми. Наприклад, у категорії "General" зібрані шари без ухилу на щось (вони показують все одразу, грубо кажучи). У категорії "Public Transport" - як можна здогадатися з назви, знаходяться шари, що відображають маршрути громадського транспорту.

Категорію можна згорнути, щоб зробити перелік шарів коротшим та скоротити час його прокрутки. Для цього потрібно натиснути на флажок поряд з назвою відповідної категорії.

## Посилання на координати і шари

Є можливість створити посилання на місце на мапі та обраний шар (або шари, якщо показується хоча б один накладний шар). Для цього потрібно натиснути на посилання "Permalink" у лівому верхньому куті екрану та скопіювати адресу з адресної строки браузера. Також можна просто скопіювати адресу посилання. Координати та обрані шари у посиланні оновлюються автоматично за іх зміною.

Інформація про координати і шар (шари) зберігається у хеші - це частина URL після символу `#`.

Формат кінцевого хешу - як на сайті [http://www.openstreetmap.org/](http://www.openstreetmap.org/): `#map={зум}/{широта (latitude)}/{довгота (longitude)}&layers={перелік шарів у форматі "базовий шар [,накладний шар 1] [,накладний шар 2]..."}`

Сайт розуміє кілька форматів хешів:

* Описаний вище. Використовується, наприклад, на http://www.openstreetmap.org/ і http://www.openstreetmap.ru/
* `#zoom={зум}&lat={широта (latitude)}&lon={довгота (longitude)}`. Використовується, наприклад, на [http://pavlo-dudka.github.io/](http://pavlo-dudka.github.io/osm-pg-tests/test.html?map?dead.nodes#zoom=6&lat=49&lon=31)
* `#{зум}/{широта (latitude)}/{довгота (longitude)}`. Використовується, наприклад, на [http://resultmaps.neis-one.org/osm-changesets](http://resultmaps.neis-one.org/osm-changesets?comment=mapping_party#18/44.51155/11.33740)

Завдяки цьому можна швидко переходити з одного сайту на інший. Наприклад, ви побачили помилку в одному з валідаторів [http://pavlo-dudka.github.io/](http://pavlo-dudka.github.io/), і хочете подивитись, як виглядає це місце на супутникових знімках. Порядок дій наступний:

1. Скопіювати посилання на це місце на цьому сайті
2. Вставити її, наприклад, в адресну строку браузера
3. Залишити тільки хеш, все інше прибрати
4. Скопіювати отриманий хеш
5. Набрати в адресній строчці `http://edward17.github.io/LayersCollection/` і вставити у кінці отриманий хеш
6. Мапа відкриється на цьому місці. Тепер можна переключатись, наприклад, на шар супутникових знімків

У хеші з сайта http://www.openstreetmap.org/ зберігаються не тільки координати, але й обраний шар. Якщо вставити такий хеш, то на мапі автоматично буде показаний цей шар.

Також можна використовувати цей сайт як конвертер координат з різних форматів у формат [http://www.openstreetmap.org/](http://www.openstreetmap.org/).

## Фільтри

На поточний момент на сайті зібрано достатньо багато різноманітних шарів. Для того, щоб полегшити пошук шару за певними умовами, створені фільтри:

* Language (код мови на зеленому фоні) - мова написів на мапі
* Show outdated layers (червоний "old") - показувати шари, які давно не оновлювались
* Show Ukraine-only layers (жовтий "ua") - показувати шари, які покривають тільки Україну. Актуально для мешканців інших країн, які не знайдуть на цих шарах нічого цікавого
* Show only black/white layers (сірий "b/w") - показувати **тільки** чорно-білі шари. Можуть використовуватись, наприклад, для друку
* Show only 3D-buildings layers (фіолетовий "3D") - показувати **тільки** шари, у яких на великих зумах малюються об'ємні будівлі
* Show only Retina layers (помаранчевий "rtn")  - показувати **тільки** шари для екранів Retina
* Show only no-labels layers (темно-синій "nl") - показувати **тільки** шари без написів. Вони можуть використовуватись як основа для мапи зі своїми написами

Підтримується активація кількох фільтрів одночасно.

Окрім того, кожний фільтр має певну "бирку" (в списку вище вони описані у дужках). Якщо шар підходить під якийсь фільтр, бирка цього фільтру зображується праворуч від назви шара.

## Власний шар

Є можливість показувати власний тайловий або WMS шар. Для цього натисніть кнопку "Add custom layer" (або "Add custom WMS layer") і заповніть поля у відкритій формі. Обов'язкові поля позначені `*`. Після цього натисніть кнопку "Show this layer" (або "Show this WMS layer").

Власний шар додається над обраним зараз базовим шаром. Якщо ваш шар має прозорий фон, але ви хочете бачити його без підкладки, то натисніть на кнопку "Set gray background" у переліку шарів.

Підтримується показ власних тайлового та WMS шарів одночасно.

Зверніть увагу:

1. Данні цього шару (адреса, авторські права, максимальний зум тощо) не зберігаються і під час перезавантаження сторінки будуть втрачені
2. За допомогою цього інструменту не можна попросити автора (мене) додати цей шар до збірки. Для цього потрібно зв'язатись зі мною, див. розділ ["Зв'язок"](https://github.com/Edward17/LayersCollection/blob/gh-pages/README.RU.md#Зв'язок)

## Експорт даних шару

Є можливість експортувати дані шару (адреса, максимальний зум тощо) для використання у наступному ПЗ:

* Бібліотека [Leaflet](http://leafletjs.com/) - для неї повертається готовий JavaScript-код, який потрібно просто вставити до коду сайту
* Редактор iD - для нього повертається адреса, яку можна вставити під час підключення налаштовуємого шару
* Редактор JOSM - для нього повертається адреса і максимальний зум (для TMS шару) або адреса, перелік шарів й формат (для WMS шару)
* SAS.Planet - для неї повертаються тексти трьох файлів, які потрібно покласти до окремої папки у папці `SAS.Planet/Maps/.../` подібно до інших шарів (підтримуються тільки тайлові шари)

Щоб експортувати дані шару, потрібно:

1. Увімкнути флажок "Show layer data by doubleclick on layer name"
2. Два рази натиснути на **назву** шару
3. Відкриється нова вкладка, звідти можна скопіювати результат

## Додавання міні-мапи на сайт

Є можливість додати міні-мапу з обраними шарами (базовий шар та необмежена кількість накладних шарів) і початковою позицією за допомогою `<iframe>`. Для цього потрібно:

1. Відкрити необхідне місце на мапі
2. Увімкнути необхідні шари
3. Натиснути на посилання "Frame export"
4. Скопіювати отриманий код і додати його до HTML-коду свого сайту

## Збереження стану сайту

Інтерфейс сайту можна змінювати. Деякі налаштування зберігаються тільки в браузері. Інші налаштування зберігаються у браузері та у посиланні. При цьому налаштування у посиланні завжди мають більший пріоритет, ніж налаштування, збережені у браузері.

Наступні налаштування зберігаються тільки у браузері:

* Чи показувати ліву панель? (На ній знаходяться фільтри, перелік шарів та багато іншого)
* Чи показувати фільтри?
* Чи активований кожний фільтр?
* Чи показувати кожну категорію?

Наступні налаштування зберігаються у браузері та у посиланні:

* Координати (широта, довгота, зум)
* Показувані шари

# Ліцензія

Див. [LICENSE.md](https://github.com/Edward17/LayersCollection/blob/gh-pages/LICENSE.md)

# Зв'язок

Є питання, пропозиції, побажання? Пишіть мені у [приватному листі на OSM](https://www.openstreetmap.org/message/new/edward17) або на e-mail: edward17 [at] mail [dot] ua.
